<div class="splide slider-gallery"
  data-splide='{"type": "loop", "arrows": true, "pagination": false, "autoWidth": true, "focus": "center", "autoplay": true, "interval": 5000, "pauseOnHover": true, "keyboard": false}'>
  <div class="splide__track">
    <ul class="splide__list">
      {%- for slide in include.slides -%}
      {%- assign idx = forloop.index0 -%}
      {%- assign gallery_size = include.gallery[idx] | size -%}      
        <li class="splide__slide" data-text="{{ slide.title | escape }}">
          <div {% if gallery_size > 0 %}data-gallery='[
            {%- for gallery in include.gallery[idx] -%}
              {"subHtml": "{{ gallery.title }}", "src": "{{ gallery.image | relative_url }}", "thumb": "{{ gallery.thumb | default: gallery.image | relative_url }}", "alt": "{{ gallery.alt | default: gallery.title | escape }}"} 
              {%- if forloop.last != true -%}, {%- endif -%}
            {%- endfor -%}
            ]' data-gallery-options='{"speed": 500}' {% endif %}class="img-fit"> 
            <img src="{{ slide.image | relative_url }}" alt="{{ slide.alt | default: slide.title | escape }}">
          </div>          
        </li>
      {%- endfor -%}
    </ul>
  </div>
</div>